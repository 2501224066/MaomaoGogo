<div class="row">
    <div class="col-md-8" id="left">
        <div class="panel">
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-2" data-toggle="modal" data-target=".bs-example-modal-sm">
                        <img data-toggle="tooltip" data-placement="bottom" title="点击更换头像"
                            class="img-responsive border-radius-2px" src="{{ .User.AvatarUrl }}">
                    </div>
                    <div class="col-md-10">
                        <p>
                            <span style="font-weight: 900; font-size: 26px">{{ .User.Nickname }}</span>&nbsp;&nbsp;
                            <span style="font-size: 16px;"> {{ .User.InShort }}</span>
                        </p>
                        <p>{{ .User.Introduce }}</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6" style="color: #999">
                        <i class="fa fa-venus-mars fa-fw gray"></i>{{ .User.Sex }}&nbsp;&nbsp;
                        <i class="fa fa-birthday-cake fa-fw gray"></i>{{ date .User.Birthday "Y-m-d" }}
                    </div>
                    <div class="col-md-6 text-right"><a href="/info_update">编辑个人资料</a></div>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading" style="border-bottom: 1px solid #eee">
                <div class="row">
                    <div class="col-md-6 text-center">
                        <a class="gray hover-blue" href="#ta" aria-controls="ta" role="tab" data-toggle="tab">
                            <strong>创建的所有文章</strong>
                        </a>
                    </div>
                </div>

            </div>
            <div class="panel-body" style="padding: 0">
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="ta">
                        <ul class="list-group">
                            {{ range .SelfArticleList }}
                            <li class="list-group-item">
                                <div style="font-size:16px;"><a class="gray">{{ .Title }}</a></div>
                                <div style="color: #999">
                                    <span class="badge">{{ .Node }}</span>
                                    &nbsp;<span class="snow">•</span>&nbsp;
                                    <span>{{ TimeInterval ( date .CreatedAt "Y-m-d H:i:s" ) }}</span>                                  
                                    &nbsp;<span class="snow">•</span>&nbsp;
                                    <span></span>{{ .ReadNum }} 阅读</span>
                                    &nbsp;<span class="snow">•</span>&nbsp;
                                    <span>{{ .LikeNum }} 柠檬</span>
                                    &nbsp;<span class="snow">•</span>&nbsp;
                                    <span>{{ .ThankNum }} 感谢</span>
                                </div>
                            </li>
                            {{ end }}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="panel">
            <div class="panel-body">
                <ol class="breadcrumb">
                    <li><i class="fa fa-smile-o fa-fw"></i>他和他的朋友们</li>
                </ol>
                <div class="row" style="margin-bottom: 10px">
                    <div class="col-md-4 text-center">
                        <img src="/static/images/header.jpg" width="50px" height="50px" class="img-circle">
                    </div>
                    <div class="col-md-8">
                        <span class="label label-primary">1996~2007</span>
                        <span class="label label-info">鱼罐头</span>
                        <span class="label label-warning">爱睡觉</span>
                    </div>
                </div>
                <div class="row" style="margin-bottom: 10px">
                    <div class="col-md-4 text-center">
                        <img src="/static/images/header.jpg" width="50px" height="50px" class="img-circle">
                    </div>
                    <div class="col-md-8">
                        <span class="label label-primary">1996~2007</span>
                        <span class="label label-success">爱运动</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <ul class="list-group">
                    <li class="list-group-item gray">
                        <span class="badge">14</span>
                        <i class="fa fa-star fa-fw"></i>我的收藏
                    </li>
                    <li class="list-group-item gray">
                        <span class="badge">14</span>
                        <i class="fa fa-heart fa-fw"></i>收到的感谢
                    </li>
                    <li class="list-group-item gray">
                        <span class="badge">14</span>
                        <i class="fa fa-gavel fa-fw"></i>举报反馈
                    </li>
                    <li class="list-group-item gray">
                        <span class="badge">14</span>
                        <i class="fa fa-magic fa-fw"></i>网站建议
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!--头像裁剪模态框start-->
<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div id="clipArea"></div>
            <input style="display: none" type="file" id="file">
            <form id="uploadForm" enctype="multipart/form-data">
                {{ .xsrfdata }}
                <div class="text-center">
                    <a class="btn btn-default" id="checkImg">选择图片</a> <button class="btn btn-primary" id="clipBtn"
                        data-dismiss="modal">更换头像</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!--头像裁剪模态框start-->

<!--头像裁剪js-->
<script src="/static/js/iscroll-zoom.js"></script>
<script src="/static/js/hammer.js"></script>
<script src="/static/js/jquery.photoClip.js"></script>
<script>
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })

    const XSRF = $('input[name="_xsrf"]').val();

    $("#checkImg").on('click', function () {
        $('#file').click()
    });

    // 图片裁剪
    $("#clipArea").photoClip({
        width: 200,
        height: 200,
        file: "#file",
        ok: "#clipBtn",
        outputType: "jpg",
        loadStart: function () {
            console.log("照片读取中");
        },
        loadComplete: function () {
            console.log("照片读取完成");
        },
        clipFinish: function (dataURL) {
            console.log(dataURL);
            // 图片上传
            var formData = new FormData();
            formData.append('file', dataURLtoFile(dataURL, randomString() + '.jpg'));
            formData.append('_xsrf', XSRF);
            $.ajax({
                url: '/upload',
                type: 'POST',
                cache: false,
                processData: false,
                contentType: false,
                data: formData,
                success: function (res) {
                    // 修改头像
                    var i = new FormData();
                    i.append('path', res.data.path);
                    i.append('_xsrf', XSRF);
                    $.ajax({
                        url: '/avatar_url_update',
                        type: 'POST',
                        cache: false,
                        processData: false,
                        contentType: false,
                        data: i,
                        success: function (res) {
                            if (res.status) {
                                $("#alert").html('<div class="text-center alert alert-success" role="alert"><strong>SUCCESS! </strong><br>' + res.msg + '</div>')
                                window.setTimeout(function () {
                                    window.location.href = "/info"
                                }, 1000);
                            } else {
                                $("#alert").html('<div class="text-center alert alert-danger" role="alert"><strong>ERROR! </strong><br>' + res.msg + '</div>')
                            }
                        }
                    })
                }
            })
        }
    })
</script>